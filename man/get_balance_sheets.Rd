% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_balance_sheets.R
\name{get_balance_sheets}
\alias{get_balance_sheets}
\title{Download balance sheets from \href{https://www.bcb.gov.br/estabilidadefinanceira/balancetesbalancospatrimoniais}{Brazilian Central Bank}}
\usage{
get_balance_sheets(
  instituicao = "COOPERATIVAS",
  meses = 12,
  first_year = 1993,
  final_year = as.numeric(format(Sys.time(), "\%Y")) - 1,
  out_dir = "data_raw",
  overwrite = FALSE
)
}
\arguments{
\item{instituicao}{Character vector of institution types to download.
Accepted values (case-insensitive): "BANCOS" to get data from, "COOPERATIVAS", "CONSORCIOS" (Administradoras de consórcios),
"CONGLOMERADOS" (Conglomerados financeiros), "SOCIEDADES", "BLOPRUDENCIAL" (Conglomerados Prudenciais), "COMBINADOS" (Combinados Cooperativos), "LIQUIDACAO" (Instituições em Regime Especial).
The function maps these tokens to the type names used in the \href{https://www.bcb.gov.br/estabilidadefinanceira/balancetesbalancospatrimoniais}{BCB URL}.}

\item{meses}{Integer or integer vector specifying months to download. Values
should be 1..12 (single values or vectors like c(6, 12)). When a month
single-digit is provided it is zero-padded to two digits in filenames/URLs.}

\item{first_year}{Integer, first year to download (inclusive). Defaults to
1993 (the oldest available balancete in the source).}

\item{final_year}{Integer, last year to download (inclusive). Defaults to the
previous calendar year.}

\item{out_dir}{Character, directory where downloaded ZIP files (and extracted
CSVs) will be written. The directory is created if it does not exist.}

\item{overwrite}{Logical, whether to overwrite existing files in out_dir
(default FALSE). If FALSE and a file already exists at the destination it
is treated as a successful local result.}
}
\value{
A tibble with one row per attempted download and the following
columns:
\itemize{
\item ano: Year attempted (integer).
\item meses: Month attempted (integer).
\item instituicao: Institution token used (character).
\item url: The URL attempted (character).
\item dest: Destination file path for the downloaded ZIP (character).
\item success: Logical indicating if the download (or existing-file fallback)
was considered successful.
\item http_status: HTTP status code returned by the request (integer NA if not
available).
\item error: Character string with an error message when success is FALSE, or
a short note when a local file existed and was not overwritten.
}
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Downloads monthly "balancetes" (.CSV or .ZIP) released by the Brazilian Central Bank
for one or more institution types and stores them in a local directory. ZIP
files found in the destination directory are also extracted (errors during
individual extractions are ignored).

Check the function \code{tidy_balance_sheets()} for tools to read and process
}
\details{
For each combination of year, month and institution type the function
constructs a URL of the form:
\verb{https://www.bcb.gov.br/content/estabilidadefinanceira/cosif/\{tipo\}/\{YYYY\}\{MM\}\{INSTITUICAO\}.CSV.ZIP}
and attempts to download it with httr::GET. Successful and failed attempts
are recorded in the returned tibble. After attempting all downloads the
function tries to unzip any .zip files found in out_dir; unzip errors for
individual files are caught and ignored so the process continues.

Invalid institution tokens cause an immediate error listing the invalid
entries.
}
\examples{
\dontrun{
# Download balancetes for banks and cooperatives for June and December from 1993 to 2023
get_balance_sheets(
  instituicao = c("BANCOS", "COOPERATIVAS"),
  meses = c(6, 12),
  first_year = 1993,
  final_year = 2023,
  out_dir = "data_raw",
  overwrite = FALSE
)
}

}
\references{
Source Banco Central do Brasil (Bacen): \url{https://www.bcb.gov.br/estabilidadefinanceira/balancetesbalancospatrimoniais}
Note:
The values are not changed or processed in any way, they are downloaded as-is from the source.
Check the function \code{treat_balance_sheets()} for tools to read and process
Site: https://www.bcb.gov.br/estabilidadefinanceira/balancetesbalancospatrimoniais
}
